<!doctype html>
<head>
<meta charset="utf-8">
<title>memory-space</title>
<link rel="stylesheet" href="simics.css">
<script>function postUrl() {
    window.parent.postMessage({ content_url: window.location.href }, "*");
}
if (window.parent != null && window.parent != window) {
    postUrl();
    window.addEventListener("hashchange", function () {
        postUrl();
    });
} else {
    // Check if we are part of a Simics doc site and redirect if we are
    fetch("../simics-doc-site-marker", { method: "HEAD" }).then(response => {
        if (response.ok) {
            window.location = "..#" + window.location.href;
        } else {
            console.info("Not part of a Simics documentation site");
        }
    }).catch(error => {
        console.warn("Failed to check if this is a Simics documentation site:",
            error);
    });
}</script>
</head>
<div class="chain">
<a href="rm-class-mem-traffic-meter.html">mem-traffic-meter</a>
<a href="rm-class-memory_profiler.html">memory_profiler</a>
</div>
<div class="path">
<a href="index.html">Simics Reference Manual</a>
&nbsp;/&nbsp;
<a href="rm-classes.html">5 Classes</a>
&nbsp;/&nbsp;</div>
<h1 id="memory-space"><a href="#memory-space">memory-space</a></h1>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description">
<a href="#description">Description</a>
</h3>
Instances of the <tt>memory-space</tt> class provide linear address spaces into which devices and memory can be mapped.
<h3 id="interfaces-implemented">
<a href="#interfaces-implemented">Interfaces Implemented</a>
</h3>conf_object, log_object, translator, transaction, memory_space, translate, map_demap, direct_memory_lookup, direct_memory_lookup_v2, breakpoint, breakpoint_trigger, breakpoint_query_v2, breakpoint_query
<h3 id="commands-for-this-class">
<a href="#commands-for-this-class">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-memory-space.add-map.html">add-map</a>
 – map device in a memory-space</li>
<li>
<a href="rm-cmd-memory-space.del-map.html">del-map</a>
 – remove device map from a memory-space</li>
<li>
<a href="rm-cmd-memory-space.info.html">info</a>
 – print information about the object</li>
<li>
<a href="rm-cmd-memory-space.map.html">map</a>
 – print memory map</li>
<li>
<a href="rm-cmd-memory-space.status.html">status</a>
 – print status of the object</li>
</ul>
<h3 id="commands-for-interface-translator">
<a href="#commands-for-interface-translator">Commands for interface translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
<h3 id="commands-for-interface-transaction">
<a href="#commands-for-interface-transaction">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
<h3 id="commands-for-interface-memory_space">
<a href="#commands-for-interface-memory_space">Commands for interface memory_space</a>
</h3>
<ul>
<li>
<a href="rm-cmd-memory_space.debug.html">debug</a>
 – get debug object</li>
<li>
<a href="rm-cmd-get.html">get</a>
 – get value from physical address without side-effects</li>
<li>
<a href="rm-cmd-memory_space.get-string.html">get-string</a>
 – read a string from memory</li>
<li>
<a href="rm-cmd-load-binary.html">load-binary</a>
 – load binary (executable) file into memory</li>
<li>
<a href="rm-cmd-load-file.html">load-file</a>
 – load file into memory</li>
<li>
<a href="rm-cmd-load-intel-hex.html">load-intel-hex</a>
 – load Intel HEX file into memory</li>
<li>
<a href="rm-cmd-load-intel-obj.html">load-intel-obj</a>
 – load Intel .obj or .32.obj file into memory</li>
<li>
<a href="rm-cmd-memory_space.load-vmem.html">load-vmem</a>
 – load Verilog VMEM file into memory</li>
<li>
<a href="rm-cmd-get.html">read</a>
 – read value from physical address</li>
<li>
<a href="rm-cmd-memory_space.get-string.html">read-string</a>
 – read a string from memory</li>
<li>
<a href="rm-cmd-save-file.html">save-file</a>
 – save memory contents to a binary file</li>
<li>
<a href="rm-cmd-save-intel-obj.html">save-intel-32-obj</a>
 – save memory contents to an Intel .32.obj file</li>
<li>
<a href="rm-cmd-save-intel-hex.html">save-intel-hex</a>
 – save memory contents to an Intel HEX file</li>
<li>
<a href="rm-cmd-save-intel-obj.html">save-intel-obj</a>
 – save memory contents to an Intel .obj file</li>
<li>
<a href="rm-cmd-memory_space.save-vmem.html">save-vmem</a>
 – save VMEM file of memory</li>
<li>
<a href="rm-cmd-set.html">set</a>
 – set physical address to specified value without side-effects</li>
<li>
<a href="rm-cmd-memory_space.set-string.html">set-string</a>
 – write a string to memory</li>
<li>
<a href="rm-cmd-set.html">write</a>
 – set physical address to specified value</li>
<li>
<a href="rm-cmd-memory_space.set-string.html">write-string</a>
 – write a string to memory</li>
<li>
<a href="rm-cmd-x.html">x</a>
 – examine raw memory contents</li>
</ul>
<h3 id="commands-for-interface-breakpoint">
<a href="#commands-for-interface-breakpoint">Commands for interface breakpoint</a>
</h3>
<ul>
<li>
<a href="rm-cmd-breakpoint.bp-break-memory.html">bp-break-memory</a>
 – set break on memory access</li>
<li>
<a href="rm-cmd-breakpoint.bp-run-until-memory.html">bp-run-until-memory</a>
 – run until specified memory access</li>
<li>
<a href="rm-cmd-breakpoint.bp-trace-memory.html">bp-trace-memory</a>
 – enable tracing of memory accesses</li>
<li>
<a href="rm-cmd-breakpoint.bp-wait-for-memory.html">bp-wait-for-memory</a>
 – wait for specified memory access</li>
<li>
<a href="rm-cmd-breakpoint.break.html">break</a>
 – <i>deprecated</i> set breakpoint</li>
<li>
<a href="rm-cmd-breakpoint.break.html">tbreak</a>
 – <i>deprecated</i> set temporary breakpoint on current processor</li>
</ul>
<h3 id="attributes">
<a href="#attributes">Attributes</a>
</h3>
<dl>
<dt id="dt:map">
<i>map</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>[[io|[os|n]iii]|[io|[os|n]iiio|[os|n]|n]|[io|[os|n]iiio|[os|n]|ni]|[io|[os|n]iiio|[os|n]|nii]|[io|[os|n]iiio|[os|n]|niii]*]</code>
<br>((<i>base</i>, <i>object</i> <b>or</b> (<i>object</i>, "<i>port</i>"), <i>function</i>, <i>offset</i>, <i>length</i>, <i>target</i>, <i>priority</i>, <i>align-size</i>, <i>byte-swap</i>)*).<br>
<br>
 Maps zero or more objects in the memory space. If <tt>target</tt> is not NIL, then <tt>object</tt> must implement at least one of the <tt>translator</tt>, <tt>translate</tt>, or <tt>bridge</tt> interfaces, searched in that order. The <tt>target</tt>, or <tt>object</tt> if <tt>target</tt> is NIL, must implement at least one of the <tt>ram</tt>, <tt>rom</tt>, <tt>io_memory</tt>, <tt>port_space</tt>, <tt>transaction</tt>, <tt>translator</tt>, or <tt>transaction_translator</tt> interfaces, searched in that order, or it can implement both <tt>translate</tt> and <tt>memory_space</tt>. (Some of these interfaces are Simics internal and cannot be implemented by user-defined classes).<br>
<br>
 If <tt>object</tt> only implements the <tt>bridge</tt> interface, then the <tt>target</tt> field must be set. If <tt>object</tt> implements <tt>translator</tt>, or <tt>translate</tt>, then <tt>target</tt> is optional and used as default target.<br>
<br>
The <tt>memory-space</tt> class implements the <tt>translator</tt>, <tt>translate</tt> and <tt>memory_space</tt> interfaces, and can thus be passed as <tt>object</tt>, without any <tt>target</tt>.<br>
<br>
 <tt>object</tt> is mapped in the address space from <i>base</i> to <i>base</i> + <i>length</i> - 1 (inclusive). For a DML device, <tt>object</tt> is usually the bank object (<tt>object.bank.&lt;bank_name&gt;</tt>). A deprecated alternative is to map a port interface, represented by a pair [<tt>object</tt>, "portname"]. The <i>function</i> field is deprecated and usually equals 0. It is passed to io_memory.operation() as a field in the map_info struct argument; it is used in some legacy PCI device models to select bank. The <i>priority</i> (-32768 – 32767) is used when multiple mappings exist on the same address. The mapping with the lowest number has the highest priority.<br>
<br>
 If the map target does not support large accesses, then <i>align-size</i> can be set to the maximum allowed size (which must be a power of two). Accesses spanning align boundaries will be split into several smaller transactions. By default, the align size is set to 4 for port-space devices and 8 for other devices, but is not used for memory. Mappings with an <i>align-size</i> of 2, 4, or 8 may set the <i>byte-swap</i> field to 1, 2 or 3. A value of 1 will model bridges that perform byte swapping on a specific bus width. 3 will swap all bytes in the transaction based on the access size. And with 2 the bus and transaction byte-swap variants will be combined. Consider a mapping with a 4-byte align size and memory at address 0 that contains the bytes: 0x00 0x01 0x02 0x03. A 2-byte big-endian read access at address 0 will give the following values as results. No swap: 0x0001, bus swap: 0x0302, bus and transaction swap: 0x0203 and transaction swap: 0x0100.<br>
<br>
 The typical syntax for this attribute is: <br>
<br>
 <tt>memory-space</tt>.<tt>map</tt> = [<br>
 [0xa000, <tt>obj.bank.foo</tt>, 0, 0, 0x1000],<br>
 [0xf000, <tt>obj.bank.bar</tt>, 0, 0, 0x0200]<br>
 ]<br>
<br>
 This will map the bank <i>foo</i> at 0xa000. The length of the mapping is 0x1000 bytes. Similarly, the bank <i>bar</i> will be mapped at 0xf000 with a length of 0x0200 bytes.</dd>
<dt id="dt:timing_model">
<i>timing_model</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>o|[os]|n</code>
<br>The timing_model is called when a memory operation reaches the memory-space, before it is performed. The model has to implement the "timing_model" interface.</dd>
<dt id="dt:snoop_device">
<i>snoop_device</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>o|[os]|n</code>
<br>The snoop_device is similar to a timing-model, but called after a memory operation is complete. The object has to implement the "snoop_memory" interface, but the returned stall time is ignored.</dd>
<dt id="dt:default_target">
<i>default_target</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>[o|[os|n]iio|[os|n]|n]|[o|[os|n]iio|[os|n]|ni]|[o|[os|n]iio|[os|n]|nii]|n</code>
<br>(<i>object</i>, <i>function</i>, <i>offset</i>, <i>target</i>, <i>align-size</i>, <i>byte-swap</i>).<br>
 An access not targeting any object in the <tt>map</tt> attribute will be forwarded to the default target. See the <tt>map</tt> attribute for an explanation of the list entries.</dd>
<dt id="dt:unmapped_read_value">
<i>unmapped_read_value</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>n|i</code>
<br>The byte pattern defined in this attribute will be replicated to represent the value read from unmapped addresses. The default value (nil), will generate an error on such accesses.</dd>
<dt id="dt:ignore_unmapped_writes">
<i>ignore_unmapped_writes</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>b</code>
<br>Set to true to ignore unmapped write accesses; otherwise, they generate an error. Default is false.</dd>
<dt id="dt:memory">
<i>memory</i>
</dt>
<dd>
<b>Pseudo</b> attribute; 
<b>read/write</b> access; type: 
<code>d</code>
<br>Read from or write to the space. Data is read without side effects (with the inquiry bit set), while writes are allowed to trigger side effects (including actually writing the data).</dd>
</dl>
<h3 id="provided-by">
<a href="#provided-by">Provided By</a>
</h3>
<a href="mod.simics.core.html">Simics Core</a>
</section>
<div class="chain">
<a href="rm-class-mem-traffic-meter.html">mem-traffic-meter</a>
<a href="rm-class-memory_profiler.html">memory_profiler</a>
</div>