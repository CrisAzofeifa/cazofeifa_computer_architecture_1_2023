<!doctype html>
<head>
<meta charset="utf-8">
<title>pcie-downstream-port-legacy</title>
<link rel="stylesheet" href="simics.css">
<script>function postUrl() {
    window.parent.postMessage({ content_url: window.location.href }, "*");
}
if (window.parent != null && window.parent != window) {
    postUrl();
    window.addEventListener("hashchange", function () {
        postUrl();
    });
} else {
    // Check if we are part of a Simics doc site and redirect if we are
    fetch("../simics-doc-site-marker", { method: "HEAD" }).then(response => {
        if (response.ok) {
            window.location = "..#" + window.location.href;
        } else {
            console.info("Not part of a Simics documentation site");
        }
    }).catch(error => {
        console.warn("Failed to check if this is a Simics documentation site:",
            error);
    });
}</script>
</head>
<div class="chain">
<a href="rm-class-pcie-downstream-port.html">pcie-downstream-port</a>
<a href="rm-class-pcie-switch.html">pcie-switch</a>
</div>
<div class="path">
<a href="index.html">Simics Reference Manual</a>
&nbsp;/&nbsp;
<a href="rm-classes.html">5 Classes</a>
&nbsp;/&nbsp;</div>
<h1 id="pcie-downstream-port-legacy"><a href="#pcie-downstream-port-legacy">pcie-downstream-port-legacy</a></h1>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description">
<a href="#description">Description</a>
</h3>
This is the legacy-compatible variant of the pcie-downstream-port class
<h3 id="interfaces-implemented">
<a href="#interfaces-implemented">Interfaces Implemented</a>
</h3>conf_object, log_object, io_memory, pci_bus, pci_downstream, pci_express, pci_upstream, pci_upstream_operation, pcie_map, pcie_port_control, transaction, translator
<h3 id="port-objects">
<a href="#port-objects">Port Objects</a>
</h3>
<dl>
<dt id="dt:cfg_space">cfg_space</dt>
<dd>
<a href="rm-class-memory-space.html#memory-space">memory-space</a>
 – downstream Config space</dd>
<dt id="dt:conf_space">conf_space</dt>
<dd>
<a href="rm-class-memory-space.html#memory-space">memory-space</a>
 – legacy Config space</dd>
<dt id="dt:impl-cfg_to_conf">impl.cfg_to_conf</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#impl.cfg_to_conf">pcie-downstream-port-legacy.impl.cfg_to_conf</a>
 – translates to legacy conf space</dd>
<dt id="dt:impl-conf_to_cfg">impl.conf_to_cfg</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#impl.conf_to_cfg">pcie-downstream-port-legacy.impl.conf_to_cfg</a>
 – translates from legacy conf space</dd>
<dt id="dt:impl-transaction_to_pci_express">impl.transaction_to_pci_express</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#impl.transaction_to_pci_express">pcie-downstream-port-legacy.impl.transaction_to_pci_express</a>
 – translates from transaction to legacy pci_express</dd>
<dt id="dt:io_space">io_space</dt>
<dd>
<a href="rm-class-memory-space.html#memory-space">memory-space</a>
 – downstream I/O space</dd>
<dt id="dt:mem_space">mem_space</dt>
<dd>
<a href="rm-class-memory-space.html#memory-space">memory-space</a>
 – downstream Memory space</dd>
<dt id="dt:msg_space">msg_space</dt>
<dd>
<a href="rm-class-memory-space.html#memory-space">memory-space</a>
 – downstream Message space</dd>
<dt id="dt:port-hot_reset">port.HOT_RESET</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#HOT_RESET">pcie-downstream-port-legacy.HOT_RESET</a>
</dd>
<dt id="dt:port-broadcast">port.broadcast</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#broadcast">pcie-downstream-port-legacy.broadcast</a>
</dd>
<dt id="dt:port-cfg">port.cfg</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#cfg">pcie-downstream-port-legacy.cfg</a>
 – access point into downstream Config space</dd>
<dt id="dt:port-downstream">port.downstream</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#downstream">pcie-downstream-port-legacy.downstream</a>
 – access point into downstream PCIe space</dd>
<dt id="dt:port-ecam">port.ecam</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#ecam">pcie-downstream-port-legacy.ecam</a>
 – ECAM configuration space</dd>
<dt id="dt:port-io">port.io</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#io">pcie-downstream-port-legacy.io</a>
 – access point into downstream I/O space</dd>
<dt id="dt:port-mem">port.mem</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#mem">pcie-downstream-port-legacy.mem</a>
 – access point into downstream Memory space</dd>
<dt id="dt:port-msg">port.msg</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#msg">pcie-downstream-port-legacy.msg</a>
 – access point into downstream Message space</dd>
<dt id="dt:port-upstream">port.upstream</dt>
<dd>
<a href="rm-class-pcie-downstream-port-legacy.html#upstream">pcie-downstream-port-legacy.upstream</a>
</dd>
</dl>
<h3 id="commands-for-this-class">
<a href="#commands-for-this-class">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.info.html">info</a>
 – print information about the object</li>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.status.html">status</a>
 – print status of the object</li>
</ul>
<h3 id="commands-for-interface-transaction">
<a href="#commands-for-interface-transaction">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
<h3 id="commands-for-interface-translator">
<a href="#commands-for-interface-translator">Commands for interface translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
<h3 id="attributes">
<a href="#attributes">Attributes</a>
</h3>
<dl>
<dt id="dt:bridge">
<i>bridge</i>
</dt>
<dd>
<b>Pseudo</b> attribute; 
<b>read-only</b> access; type: 
<code>o|[os]|n</code>
<br>Pseudo-attribute to make this look like a legacy pcie-bus</dd>
<dt id="dt:bus_number">
<i>bus_number</i>
</dt>
<dd>
<b>Pseudo</b> attribute; 
<b>read/write</b> access; type: 
<code>i</code>
<br>Secondary bus number</dd>
<dt id="dt:devices">
<i>devices</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>[[iio]|[io]|o*]</code>
<br>Connected PCIe devices. Format is (device_number, function_number, object)*). The <i>device_number</i> can be omitted, in which case <i>function_number</i> is an 8-bit or 16-bit number. In the case of a 16-bit number, the bus number (bits 8 through 15) is hardcoded for this device, even though it is physically connected to whatever bus this downstream port is configured to. The <i>object</i> must implement the <tt>pcie_device</tt> interface. Note that after being connected, devices must add their functions through the <tt>pcie_map</tt> interface, no transactions will be forwarded to the device by default. If both <i>device_number</i> and <i>function_number</i> are omitted, the <i>object</i> does not correspond to a physical device on this bus, but will receive the same calls as any other device. This is useful for transparent bridges to other buses.</dd>
<dt id="dt:memory_space">
<i>memory_space</i>
</dt>
<dd>
<b>Pseudo</b> attribute; 
<b>read/write</b> access; type: 
<code>o</code>
<br>Legacy Memory space</dd>
<dt id="dt:pci_devices">
<i>pci_devices</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>[[iio]|[iioi]*]</code>
<br>((<i>id</i>, <i>function</i>, <i>object</i>)*). <i>id</i> is the PCI device id. <i>function</i> is the PCI device logical function. <i>object</i> is the PCI device itself, which must implement the <tt>pci_device</tt> interface. The object can also optionally implement either or both of: the <tt>pci_express</tt> interface, a port-object named 'port.pcie_message' implementing the <tt>transaction</tt> interface. The tuple may also contain an additional integer that tells if the PCI device is enabled or not. As default the PCI device is enabled.</dd>
<dt id="dt:sec_bus_num">
<i>sec_bus_num</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>i</code>
<br>Secondary Bus Number</dd>
<dt id="dt:transparent_enabled">
<i>transparent_enabled</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>b</code>
<br>If TRUE, this bus operates in transparent mode, all ranges mapped by devices on this bus will be mapped in the upstream target of this bus. The sec_bus_num will be claimed in the upstream config and message space.</dd>
<dt id="dt:upstream_target">
<i>upstream_target</i>
</dt>
<dd>
<b>Optional</b> attribute; 
<b>read/write</b> access; type: 
<code>o|[os]|n</code>
<br>Target receiving all upstream transactions</dd>
</dl>
<h3 id="provided-by">
<a href="#provided-by">Provided By</a>
</h3>
<a href="mod.pcie-downstream-port.html">pcie-downstream-port</a>
</section>
<h2 id="HOT_RESET"><a href="#HOT_RESET">pcie-downstream-port-legacy.HOT_RESET</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="interfaces-implemented-2">
<a href="#interfaces-implemented-2">Interfaces Implemented</a>
</h3>conf_object, log_object, signal
</section>
<h2 id="broadcast"><a href="#broadcast">pcie-downstream-port-legacy.broadcast</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="interfaces-implemented-3">
<a href="#interfaces-implemented-3">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction
<h3 id="commands-for-interface-transaction-2">
<a href="#commands-for-interface-transaction-2">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
</section>
<h2 id="cfg"><a href="#cfg">pcie-downstream-port-legacy.cfg</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-2">
<a href="#description-2">Description</a>
</h3>
access point into downstream Config space
<h3 id="interfaces-implemented-4">
<a href="#interfaces-implemented-4">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction_translator
<h3 id="commands-for-this-class-2">
<a href="#commands-for-this-class-2">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.cfg.map.html">map</a>
 – print memory map</li>
</ul>
<h3 id="commands-for-interface-transaction_translator">
<a href="#commands-for-interface-transaction_translator">Commands for interface transaction_translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction_translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="downstream"><a href="#downstream">pcie-downstream-port-legacy.downstream</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-3">
<a href="#description-3">Description</a>
</h3>
access point into downstream PCIe space
<h3 id="interfaces-implemented-5">
<a href="#interfaces-implemented-5">Interfaces Implemented</a>
</h3>conf_object, log_object, pcie_device, pcie_port_control, transaction, transaction_translator
<h3 id="commands-for-interface-transaction-3">
<a href="#commands-for-interface-transaction-3">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
<h3 id="commands-for-interface-transaction_translator-2">
<a href="#commands-for-interface-transaction_translator-2">Commands for interface transaction_translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction_translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="ecam"><a href="#ecam">pcie-downstream-port-legacy.ecam</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-4">
<a href="#description-4">Description</a>
</h3>
ECAM configuration space
<h3 id="interfaces-implemented-6">
<a href="#interfaces-implemented-6">Interfaces Implemented</a>
</h3>conf_object, log_object, translator
<h3 id="commands-for-interface-translator-2">
<a href="#commands-for-interface-translator-2">Commands for interface translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="impl.cfg_to_conf"><a href="#impl.cfg_to_conf">pcie-downstream-port-legacy.impl.cfg_to_conf</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-5">
<a href="#description-5">Description</a>
</h3>
translates to legacy conf space
<h3 id="interfaces-implemented-7">
<a href="#interfaces-implemented-7">Interfaces Implemented</a>
</h3>conf_object, log_object, translator
<h3 id="commands-for-interface-translator-3">
<a href="#commands-for-interface-translator-3">Commands for interface translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="impl.conf_to_cfg"><a href="#impl.conf_to_cfg">pcie-downstream-port-legacy.impl.conf_to_cfg</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-6">
<a href="#description-6">Description</a>
</h3>
translates from legacy conf space
<h3 id="interfaces-implemented-8">
<a href="#interfaces-implemented-8">Interfaces Implemented</a>
</h3>conf_object, log_object, translator
<h3 id="commands-for-interface-translator-4">
<a href="#commands-for-interface-translator-4">Commands for interface translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="impl.transaction_to_pci_express"><a href="#impl.transaction_to_pci_express">pcie-downstream-port-legacy.impl.transaction_to_pci_express</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-7">
<a href="#description-7">Description</a>
</h3>
translates from transaction to legacy pci_express
<h3 id="interfaces-implemented-9">
<a href="#interfaces-implemented-9">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction
<h3 id="commands-for-interface-transaction-4">
<a href="#commands-for-interface-transaction-4">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
</section>
<h2 id="io"><a href="#io">pcie-downstream-port-legacy.io</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-8">
<a href="#description-8">Description</a>
</h3>
access point into downstream I/O space
<h3 id="interfaces-implemented-10">
<a href="#interfaces-implemented-10">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction_translator
<h3 id="commands-for-this-class-3">
<a href="#commands-for-this-class-3">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.io.map.html">map</a>
 – print memory map</li>
</ul>
<h3 id="commands-for-interface-transaction_translator-3">
<a href="#commands-for-interface-transaction_translator-3">Commands for interface transaction_translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction_translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="mem"><a href="#mem">pcie-downstream-port-legacy.mem</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-9">
<a href="#description-9">Description</a>
</h3>
access point into downstream Memory space
<h3 id="interfaces-implemented-11">
<a href="#interfaces-implemented-11">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction_translator
<h3 id="commands-for-this-class-4">
<a href="#commands-for-this-class-4">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.mem.map.html">map</a>
 – print memory map</li>
</ul>
<h3 id="commands-for-interface-transaction_translator-4">
<a href="#commands-for-interface-transaction_translator-4">Commands for interface transaction_translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction_translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="msg"><a href="#msg">pcie-downstream-port-legacy.msg</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="description-10">
<a href="#description-10">Description</a>
</h3>
access point into downstream Message space
<h3 id="interfaces-implemented-12">
<a href="#interfaces-implemented-12">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction_translator
<h3 id="commands-for-this-class-5">
<a href="#commands-for-this-class-5">Commands for this class</a>
</h3>
<ul>
<li>
<a href="rm-cmd-pcie-downstream-port-legacy.msg.map.html">map</a>
 – print memory map</li>
</ul>
<h3 id="commands-for-interface-transaction_translator-5">
<a href="#commands-for-interface-transaction_translator-5">Commands for interface transaction_translator</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction_translator.memory-map.html">memory-map</a>
 – print physical memory map</li>
</ul>
</section>
<h2 id="upstream"><a href="#upstream">pcie-downstream-port-legacy.upstream</a></h2>
<section class="doc-item not-numbered not-in-toc">
<h3 id="interfaces-implemented-13">
<a href="#interfaces-implemented-13">Interfaces Implemented</a>
</h3>conf_object, log_object, transaction
<h3 id="commands-for-interface-transaction-5">
<a href="#commands-for-interface-transaction-5">Commands for interface transaction</a>
</h3>
<ul>
<li>
<a href="rm-cmd-transaction.wait-for-get.html">wait-for-get</a>
 – issue an inquiry read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-read.html">wait-for-read</a>
 – issue a read transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-set.html">wait-for-set</a>
 – issue an inquiry write transaction and wait for it to complete</li>
<li>
<a href="rm-cmd-transaction.wait-for-write.html">wait-for-write</a>
 – issue a write transaction and wait for it to complete</li>
</ul>
</section>
<div class="chain">
<a href="rm-class-pcie-downstream-port.html">pcie-downstream-port</a>
<a href="rm-class-pcie-switch.html">pcie-switch</a>
</div>