<!doctype html>
<head>
<meta charset="utf-8">
<title>2.6 Event system</title>
<link rel="stylesheet" href="simics.css">
<script>function postUrl() {
    window.parent.postMessage({ content_url: window.location.href }, "*");
}
if (window.parent != null && window.parent != window) {
    postUrl();
    window.addEventListener("hashchange", function () {
        postUrl();
    });
} else {
    // Check if we are part of a Simics doc site and redirect if we are
    fetch("../simics-doc-site-marker", { method: "HEAD" }).then(response => {
        if (response.ok) {
            window.location = "..#" + window.location.href;
        } else {
            console.info("Not part of a Simics documentation site");
        }
    }).catch(error => {
        console.warn("Failed to check if this is a Simics documentation site:",
            error);
    });
}</script>
</head>
<div class="chain">
<a href="software-tracker-scripting.html">2.5 Scripting</a>
<a href="tracker-parameters.html">2.7 Tracker Parameters</a>
</div>
<div class="path">
<a href="index.html">Analyzer User's Guide</a>
&nbsp;/&nbsp;
<a href="target-software-tracking.html">2 OS Awareness</a>
&nbsp;/&nbsp;</div>
<h1 id="event-system">2.6 <a href="#event-system">Event system</a></h1>
<p>The OS Awareness framework provides two different types of callbacks. The first type is notifications about changes to the node tree, as explained in section <a class="reference" href="software-tracker-scripting.html">2.5</a>. These changes are persistent until they are updated by the tracker or the node is destroyed.</p>
<p>The second type of notifications are called events. These are used for notifying about changes that are not persistent and hence not part of the node tree. It is up to each tracker to define the list of supported events. For example, the Linux tracker supports system call notification via the event system, see section <a class="reference" href="linux-tracker.html#system-calls">2.13.4</a> for more details.</p>
<p>It is possible to register an event notification callback by calling the <code>notify_event</code> function in the <code>osa_node_tree_notification</code> interface. See the <em>API â€“ Reference Manual</em> for details.</p>
<p>Here follows a simple example of the event notification system. It registers a callback function for all events on all nodes generated by the tracker. When this callback is triggered the simulation will be stopped. This Python example assumes that the system is named <code>board</code>.</p>
<p>
</p><pre><code>import simics
import conf

def event_cb(cb_data, admin, cpu, node_id, event_name, event_data):
    simics.SIM_break_simulation(
        "Got event '%s' on the %s cpu with event data '%s'"
        % (event_name, cpu.name, event_data))

def break_on_event(software_comp):
    root_node = software_comp.iface.osa_component.get_root_node()
    if not root_node.valid:
        print ("No root node present")
        return
    root_id = root_node.id
    admin = software_comp.iface.osa_component.get_admin()
    notification_ifc = admin.iface.osa_node_tree_notification
    notification_ifc.notify_event(root_id, None, True, event_cb, None)

break_on_event(conf.board.software)
</code></pre>
<p></p>
<div class="note"> 
<p>Remember that this will only work if the tracker is enabled. It can be enabled with the <code>enable-tracker</code> command.</p>
</div>

<div class="chain">
<a href="software-tracker-scripting.html">2.5 Scripting</a>
<a href="tracker-parameters.html">2.7 Tracker Parameters</a>
</div>